# STRIDE — Анализ угроз

Ниже приведена таблица потенциальных угроз по некоторым из ключевых потоков данных

| Поток/Элемент       | STRIDE (S/T/R/I/D/E)       | Описание угрозы                                                              | Контроль                                                                                         | Ссылка на NFR | Проверка/Артефакт                   |
|---------------------|----------------------------|------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------|---------------|-------------------------------------|
| F1: Регистрация     | S (Spoofing)               | Злоумышленник регистрирует аккаунт на чужую почту.                           | Подтверждение email через отправку уникальной ссылки.                                            | -             | `user_service.py`                   |
| F2: Запись в БД     | I (Information Disclosure) | Пароли пользователей хранятся в базе данных в нехэшированном виде.           | Хеширование паролей с использованием стойкого алгоритма (`Argon2id`).                            | NFR-01        | `user_service.py`                   |
| F2: Запись в БД     | T (Tampering)              | SQL-инъекция при создании пользователя, позволяющая изменить логику запроса. | Использование ORM (`SQLAlchemy`) с параметризацией запросов.                                     | -             | `user_repo.py`                      |
| F5: Выдача JWT      | I (Information Disclosure) | Токен содержит избыточную личную информацию (например, `name`).              | Включать в токен только необходимый минимум данных (например, `user_id`).                        | NFR-08        | `user_service.py`                   |
| F8: Голосование     | T (Tampering)              | Пользователь голосует несколько раз за одну и ту же идею.                    | Проверка в БД, что пользователь ещё не голосовал за эту идею (уникальность пары `user_id+idea`). | NFR-06        | `vote_service.py`, `test_votes.py`  |
| F8: Голосование     | E (Elevation of Privilege) | Пользователь голосует на доске, которая уже закрыта.                         | Проверка статуса доски (`board.status`) перед принятием голоса.                                  | NFR-02        | `vote_service.py`, `test_boards.py` |
| F10: Закрытие доски | E (Elevation of Privilege) | Не владелец / администратор пытается закрыть доску.                          | Проверка, что `user_id` из JWT совпадает с `board.owner_id`.                                     | NFR-02        | `board_service.py`                  |
| WebApp              | I (Information Disclosure) | В сообщениях об ошибках раскрывается внутренняя структура кода или данные.   | Обработчики исключений: стандартизированный формат ошибок (RFC7807).                             | NFR-07        | `main.py` (exception handlers)      |
